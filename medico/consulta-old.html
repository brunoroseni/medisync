<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Consultas - MediSync</title>
    <link rel="stylesheet" href="../assets/css/main.css" />
  </head>

  <body class="main-layout">
    <!-- Header -->
    <header class="header">
      <div class="container">
        <nav class="nav">
          <div class="logo">
            <img
              src="../assets/img/logo-medisync.PNG"
              alt="MediSync Logo"
              style="height: 40px; vertical-align: middle; margin-right: 8px"
            />
            <h2
              style="
                color: var(--azul-escuro);
                display: inline-block;
                vertical-align: middle;
                margin: 0;
              "
            >
              MediSync
            </h2>
          </div>
          <div class="nav-menu" id="menu-consultas">
            <a href="dash-medico.html" class="nav-link">Dashboard</a>
            <a
              href="consulta.html"
              class="nav-link"
              style="background: var(--cinza-neutro)"
              >Consultas</a
            >
            <a href="cad-paciente.html" class="nav-link">Cadastrar Paciente</a>
            <a href="#relatorios" class="nav-link">Relatórios</a>
            <button onclick="logout()" class="btn btn-danger">Sair</button>
          </div>
          <button
            class="mobile-menu-toggle"
            type="button"
            aria-expanded="false"
            aria-controls="menu-consultas"
          >
            <span class="sr-only">Alternar menu</span>
            <span class="mobile-menu-toggle__icon" aria-hidden="true"></span>
          </button>
        </nav>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <div class="container">
        <!-- Header -->
        <div class="dashboard-header">
          <div>
            <h1>Gerenciar Consultas</h1>
            <p>Registre novas consultas e acompanhe o histórico</p>
          </div>
          <button class="btn btn-primary" onclick="showNewConsultaForm()">
            + Nova Consulta
          </button>
        </div>

        <!-- Nova Consulta Form (Inicialmente oculto) -->
        <div id="newConsultaForm" class="card" style="display: none">
          <div class="card-header">
            <h3 class="card-title">Nova Consulta</h3>
            <button
              style="
                float: right;
                background: none;
                border: none;
                font-size: 1.5rem;
              "
              onclick="hideNewConsultaForm()"
            >
              ×
            </button>
          </div>

          <form id="consultaForm">
            <div class="grid grid-2">
              <div class="form-group">
                <label class="form-label">Buscar Paciente</label>
                <input
                  type="text"
                  class="form-input"
                  placeholder="Digite nome ou CPF do paciente"
                  onkeyup="searchPatients(this.value)"
                />
                <div id="patientResults" class="mt-2"></div>
              </div>
              <div class="form-group">
                <label class="form-label">Data e Hora</label>
                <input type="datetime-local" class="form-input" required />
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Motivo da Consulta</label>
              <input
                type="text"
                class="form-input"
                required
                placeholder="Ex: Dor no peito, consulta de rotina..."
              />
            </div>

            <div class="grid grid-2">
              <div class="form-group">
                <label class="form-label">Pressão Arterial</label>
                <input
                  type="text"
                  class="form-input"
                  placeholder="Ex: 120x80 mmHg"
                />
              </div>
              <div class="form-group">
                <label class="form-label">Frequência Cardíaca</label>
                <input
                  type="text"
                  class="form-input"
                  placeholder="Ex: 72 bpm"
                />
              </div>
            </div>

            <div class="grid grid-3">
              <div class="form-group">
                <label class="form-label">Peso (kg)</label>
                <input
                  type="number"
                  class="form-input"
                  placeholder="Ex: 70.5"
                />
              </div>
              <div class="form-group">
                <label class="form-label">Altura (cm)</label>
                <input type="number" class="form-input" placeholder="Ex: 175" />
              </div>
              <div class="form-group">
                <label class="form-label">Temperatura (°C)</label>
                <input
                  type="number"
                  step="0.1"
                  class="form-input"
                  placeholder="Ex: 36.5"
                />
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Anamnese (História Clínica)</label>
              <textarea
                class="form-input"
                rows="4"
                placeholder="Descreva os sintomas, histórico da doença atual..."
              ></textarea>
            </div>

            <div class="form-group">
              <label class="form-label">Exame Físico</label>
              <textarea
                class="form-input"
                rows="3"
                placeholder="Descreva os achados do exame físico..."
              ></textarea>
            </div>

            <div class="form-group">
              <label class="form-label">Diagnóstico</label>
              <textarea
                class="form-input"
                rows="2"
                placeholder="Diagnóstico principal e secundários..."
              ></textarea>
            </div>

            <div class="form-group">
              <label class="form-label">Prescrição Médica</label>
              <textarea
                class="form-input"
                rows="4"
                placeholder="Medicamentos, dosagens, orientações..."
              ></textarea>
            </div>

            <div class="form-group">
              <label class="form-label">Exames Solicitados</label>
              <textarea
                class="form-input"
                rows="3"
                placeholder="Liste os exames solicitados..."
              ></textarea>
            </div>

            <div class="grid grid-2">
              <div class="form-group">
                <label class="form-label">Retorno</label>
                <input type="date" class="form-input" />
              </div>
              <div class="form-group">
                <label class="form-label">Observações</label>
                <input
                  type="text"
                  class="form-input"
                  placeholder="Observações adicionais..."
                />
              </div>
            </div>

            <div class="d-flex justify-end" style="gap: var(--spacing-sm)">
              <button
                type="button"
                class="btn btn-secondary"
                onclick="hideNewConsultaForm()"
              >
                Cancelar
              </button>
              <button type="submit" class="btn btn-primary">
                Salvar Consulta
              </button>
            </div>
          </form>
        </div>

        <!-- Busca e Filtros -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Histórico de Consultas</h3>
          </div>

          <div class="grid grid-4 mb-4">
            <div class="form-group">
              <label class="form-label">Buscar Paciente</label>
              <input type="text" class="form-input" placeholder="Nome ou CPF" />
            </div>
            <div class="form-group">
              <label class="form-label">Data Inicial</label>
              <input type="date" class="form-input" />
            </div>
            <div class="form-group">
              <label class="form-label">Data Final</label>
              <input type="date" class="form-input" />
            </div>
            <div class="form-group">
              <label class="form-label">Filtrar</label>
              <button class="btn btn-secondary w-100">
                <span class="material-symbols-rounded" aria-hidden="true"
                  >search</span
                >
                Buscar
              </button>
            </div>
          </div>
        </div>

        <!-- Lista de Consultas -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Consultas Realizadas</h3>
          </div>

          <div class="table-responsive">
            <table class="table">
              <thead>
                <tr>
                  <th>Data/Hora</th>
                  <th>Paciente</th>
                  <th>Motivo</th>
                  <th>Diagnóstico</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>01/11/2024 14:30</td>
                  <td>João Silva</td>
                  <td>Consulta de retorno</td>
                  <td>HAS controlada</td>
                  <td>
                    <button class="btn btn-secondary btn-sm">
                      Ver Detalhes
                    </button>
                    <button class="btn btn-primary btn-sm">Editar</button>
                  </td>
                </tr>
                <tr>
                  <td>01/11/2024 13:00</td>
                  <td>Maria Santos</td>
                  <td>Dor no peito</td>
                  <td>Angina estável</td>
                  <td>
                    <button class="btn btn-secondary btn-sm">
                      Ver Detalhes
                    </button>
                    <button class="btn btn-primary btn-sm">Editar</button>
                  </td>
                </tr>
                <tr>
                  <td>31/10/2024 16:00</td>
                  <td>Pedro Lima</td>
                  <td>Palpitações</td>
                  <td>Arritmia sinusal</td>
                  <td>
                    <button class="btn btn-secondary btn-sm">
                      Ver Detalhes
                    </button>
                    <button class="btn btn-primary btn-sm">Editar</button>
                  </td>
                </tr>
                <tr>
                  <td>31/10/2024 14:30</td>
                  <td>Ana Costa</td>
                  <td>Check-up cardiológico</td>
                  <td>Exame normal</td>
                  <td>
                    <button class="btn btn-secondary btn-sm">
                      Ver Detalhes
                    </button>
                    <button class="btn btn-primary btn-sm">Editar</button>
                  </td>
                </tr>
                <tr>
                  <td>30/10/2024 15:30</td>
                  <td>Carlos Oliveira</td>
                  <td>Hipertensão descontrolada</td>
                  <td>HAS grave</td>
                  <td>
                    <button class="btn btn-secondary btn-sm">
                      Ver Detalhes
                    </button>
                    <button class="btn btn-primary btn-sm">Editar</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Paginação -->
          <div class="d-flex justify-between align-center mt-4">
            <p class="text-muted">Mostrando 5 de 25 consultas</p>
            <div class="d-flex" style="gap: var(--spacing-sm)">
              <button class="btn btn-secondary">« Anterior</button>
              <button class="btn btn-primary">1</button>
              <button class="btn btn-secondary">2</button>
              <button class="btn btn-secondary">3</button>
              <button class="btn btn-secondary">Próximo »</button>
            </div>
          </div>
        </div>

        <!-- Estatísticas -->
        <div class="card mt-4">
          <div class="card-header">
            <h3 class="card-title">Estatísticas do Mês</h3>
          </div>

          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-number">89</div>
              <div class="stat-label">Consultas no Mês</div>
            </div>
            <div class="stat-card">
              <div class="stat-number">67</div>
              <div class="stat-label">Pacientes Diferentes</div>
            </div>
            <div class="stat-card">
              <div class="stat-number">23</div>
              <div class="stat-label">Primeiras Consultas</div>
            </div>
            <div class="stat-card">
              <div class="stat-number">15</div>
              <div class="stat-label">Urgências</div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <p>&copy; 2024 MediSync. Sistema médico profissional.</p>
      </div>
    </footer>

    <script src="../assets/js/main.js"></script>
    <script>
      function logout() {
        localStorage.clear();
        window.location.href = "../index.html";
      }

      function showNewConsultaForm() {
        document.getElementById("newConsultaForm").style.display = "block";
        document
          .getElementById("newConsultaForm")
          .scrollIntoView({ behavior: "smooth" });
      }

      function hideNewConsultaForm() {
        document.getElementById("newConsultaForm").style.display = "none";
      }

      function searchPatients(query) {
        const resultsDiv = document.getElementById("patientResults");

        if (query.length < 2) {
          resultsDiv.innerHTML = "";
          return;
        }

        // Simular busca de pacientes
        const mockPatients = [
          { id: 1, name: "João Silva", cpf: "123.456.789-00" },
          { id: 2, name: "Maria Santos", cpf: "987.654.321-00" },
          { id: 3, name: "Pedro Lima", cpf: "456.789.123-00" },
        ];

        const filtered = mockPatients.filter(
          (p) =>
            p.name.toLowerCase().includes(query.toLowerCase()) ||
            p.cpf.includes(query)
        );

        let html = "";
        filtered.forEach((patient) => {
          html += `<div class="card" style="cursor: pointer; margin-bottom: 4px; padding: 8px;" onclick="selectPatient('${patient.name}', '${patient.cpf}')">
                    <strong>${patient.name}</strong><br>
                    <small>${patient.cpf}</small>
                </div>`;
        });

        resultsDiv.innerHTML = html;
      }

      function selectPatient(name, cpf) {
        document.querySelector(
          '#newConsultaForm input[placeholder*="Digite nome ou CPF"]'
        ).value = `${name} - ${cpf}`;
        document.getElementById("patientResults").innerHTML = "";
      }

      document
        .getElementById("consultaForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          alert("Consulta registrada com sucesso!");
          hideNewConsultaForm();
          this.reset();
        });
    </script>
  </body>
</html>
